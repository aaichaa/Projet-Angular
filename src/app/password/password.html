<div class="d-flex justify-content-center align-items-center vh-100 bg-light">
  <div class="card p-4 shadow" style="width: 100%; max-width: 500px;">

    <!-- ✅ Affichage du formulaire -->
    <ng-container *ngIf="!success">
      <div class="text-center mb-4">
        <h3 class="mt-2">Set a new password</h3>
        <p class="text-muted">Your new password must be strong and secure.</p>
      </div>

      <form (ngSubmit)="valider()">
        <!-- New password -->
        <div class="mb-3">
          <label class="form-label">New password</label>
          <div class="input-group">
            <input
              [type]="showPassword ? 'text' : 'password'"
              class="form-control"
              [(ngModel)]="newPassword"
              name="newPassword"
              required
            />
            <button
              *ngIf="newPassword.length > 0"
              type="button"
              class="btn"
              (click)="togglePassword()"
              tabindex="-1"
              aria-label="Toggle password visibility"
            >
              <!-- Eye open -->
              <svg *ngIf="!showPassword" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                   viewBox="0 0 16 16">
                <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
              </svg>
              <!-- Eye slash -->
              <svg *ngIf="showPassword" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                   viewBox="0 0 16 16">
                <path
                  d="M13.359 11.238l1.42 1.42a.5.5 0 0 1-.708.707l-1.42-1.42A8.354 8.354 0 0 1 8 13.5C3 13.5 0 8 0 8s1.479-2.71 3.781-4.53L1.146 1.854a.5.5 0 1 1 .708-.708l12 12a.5.5 0 0 1-.708.708l-1.787-1.787zM8 12.5c3.53 0 6.48-2.874 7.294-4.5C14.48 6.374 11.53 3.5 8 3.5c-.801 0-1.579.158-2.294.45l6.414 6.415c.293.362.551.738.803 1.12a.5.5 0 0 1-.707.707l-6.586-6.586a8.354 8.354 0 0 1-1.62 1.4z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Confirm password -->
        <div class="mb-3">
          <label class="form-label">Confirm new password</label>
          <input
            [type]="showPassword ? 'text' : 'password'"
            class="form-control"
            [(ngModel)]="confirmPassword"
            name="confirmPassword"
            required
          />
        </div>

        <!-- Alert -->
        <div *ngIf="erreur" class="alert alert-danger">{{ erreur }}</div>

        <!-- Submit -->
        <div class="d-grid mt-3">
          <button type="submit" class="btn btn-success">Update password</button>
        </div>
      </form>
    </ng-container>

    <!-- ✅ Message de succès -->
    <ng-container *ngIf="success">
      <div class="text-center py-4">
        <h3 class="mb-3">Password changed successfully</h3>
        <p class="text-muted">You can now sign in with your new password.</p>
        <a routerLink="/Login" class="mt-2 d-block text-decoration-none">Return to sign in</a>
      </div>
    </ng-container>

  </div>
</div>
